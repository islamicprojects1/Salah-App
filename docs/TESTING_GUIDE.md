# دليل اختبار التطبيق — Onboarding, Auth, Prayer

## تشغيل التطبيق

### على المحاكي (Android)
```bash
flutter run -d emulator-5554
```

### على جهاز حقيقي
```bash
flutter devices   # لرؤية الأجهزة المتصلة
flutter run -d <device_id>
```

### على Chrome (ويب)
```bash
flutter run -d chrome
```

---

## إعادة ضبط التطبيق (لاختبار Onboarding من جديد)

لاختبار التدفق من الصفر (Splash → Onboarding → Login):

1. **Android: إزالة البيانات**
   - الإعدادات → التطبيقات → Salah → مسح البيانات
   - أو: إلغاء تثبيت التطبيق ثم إعادة التثبيت

2. **أثناء التطوير (Debug):** أضف مؤقتاً في `main.dart` قبل `runApp`:
   ```dart
   // للتجربة فقط - احذف بعد الاختبار
   await GetStorage().erase();
   ```
   أو استدعِ من مكان آمن داخل التطبيق للاختبار.

---

## 1️⃣ اختبار Onboarding

**الملفات:** `lib/features/onboarding/`

| الصفحة | ماذا تختبر |
|--------|------------|
| **Welcome** | الترحيب، اختيار اللغة (عربي/إنجليزي)، الزر "ابدأ" |
| **Features** | عرض الميزات، زر "التالي" |
| **Family** | صفحة العائلة (اختياري)، زر "التالي" |
| **Permissions** | طلب صلاحيات الموقع والإشعارات، الأزرار تفعل الطلب |
| **Profile Setup** | الاسم، الجنس، تاريخ الميلاد، زر "إنهاء" |

**خطوات الاختبار:**
1. شغّل التطبيق أول مرة (بعد مسح البيانات).
2. تحقق أن الشاشة الأولى هي **Welcome**.
3. غيّر اللغة وتأكد من RTL/LTR.
4. اضغط "التالي" حتى صفحة الصلاحيات.
5. فعّل صلاحيتي الموقع والإشعارات.
6. في Profile Setup أدخل الاسم واختر الجنس وتاريخ الميلاد.
7. اضغط "إنهاء" → يفترض أن تنتقل إلى **Login**.

**زر Skip:** يظهر من الصفحة الثانية. اضغطه → يفترض أن ينتقل مباشرة إلى Login بدون إكمال الـ Profile.

---

## 2️⃣ اختبار Auth

**الملفات:** `lib/features/auth/`

| الشاشة | ماذا تختبر |
|--------|------------|
| **Login** | تسجيل الدخول بإيميل وكلمة مرور، Google (إن وجد)، رابط "إنشاء حساب" |
| **Register** | الاسم، الإيميل، كلمة المرور، تأكيد كلمة المرور، رابط "تسجيل الدخول" |
| **Profile Setup** | إكمال البروفايل بعد التسجيل (الاسم، الجنس، تاريخ الميلاد، صورة) |

**خطوات الاختبار — تسجيل حساب جديد:**
1. من Login اضغط "إنشاء حساب".
2. أدخل الاسم، إيميل، كلمة مرور، تأكيد كلمة مرور.
3. اضغط "تسجيل" → إن نجح → ينتقل إلى Profile Setup أو Dashboard.
4. أكمِل Profile Setup إن طُلب منك.

**خطوات الاختبار — تسجيل الدخول:**
1. أدخل الإيميل وكلمة المرور المسجّلين.
2. اضغط "تسجيل الدخول" → يفترض أن تنتقل إلى **Dashboard**.

**ملاحظة:** Auth يعتمد على Firebase. تأكد من:
- ملف `firebase_options.dart` موجود ومُعد.
- تسجيل التطبيق في Firebase Console.
- تفعيل Email/Password و Google Sign-In إن استخدمتهما.

---

## 3️⃣ اختبار Prayer

**الملفات:** `lib/features/prayer/`

| المكوّن | ماذا تختبر |
|---------|------------|
| **Dashboard** | أوقات الصلاة، الصلاة التالية، العد التنازلي، زر تعويض (إن وُجدت صلوات فائتة) |
| **Prayer Card** | عرض وقت كل صلاة، زر "صليت" |
| **Qada/تعويض** | ظهور قائمة الصلوات الفائتة، تسجيل التعويض |
| **Missed Prayers** | شاشة الصلوات الفائتة من القائمة/الدراور |
| **Qibla** | اتجاه القبلة |
| **Stats** | الإحصائيات والـ heatmap |

**خطوات الاختبار:**
1. بعد تسجيل الدخول، تحقق أن Dashboard يظهر أوقات الصلاة الصحيحة.
2. جرّب زر "صليت" على أي صلاة.
3. إن فاتتك صلوات، تحقق أن زر "تعويض" يظهر ويُفتح الـ bottom sheet.
4. من الدراور/القائمة اذهب إلى Missed Prayers واختبر القائمة والتسجيل.
5. اختبر شاشة Qibla (يتطلّب جهازاً يدعم sensors أو محاكي مع دعم).
6. اختبر شاشة الإحصائيات (Stats).

**الموقع:** الأوقات تعتمد على الموقع. للمحاكي:
- استخدم إحداثيات Mountain View أو أي مدينة.
- أو استخدم موقع جهازك الحقيقي.

---

## ملخص التدفق الكامل

```
Splash (2 ثانية)
    ├── أول مرة؟ → Onboarding (5 صفحات) → Login
    ├── غير مسجّل؟ → Login
    └── مسجّل؟ → Dashboard

Login
    ├── تسجيل دخول → Dashboard
    └── إنشاء حساب → Register → (Profile Setup) → Dashboard

Dashboard
    ├── Drawer → Profile, Settings, Missed Prayers, Stats, Qibla...
    └── زر تعويض (إذا وُجدت صلوات فائتة)
```

---

## التحقق من صحة الكود

```bash
# تحليل ثابت (بدون أخطاء)
flutter analyze

# تشغيل الاختبارات
flutter test
```
